<ion-header>
  <ion-toolbar>
    <ion-title>Question Details</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="dismissModal()">
        <ion-icon name="close-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="question-container">
    <div class="question-header">
      <h1 class="question-title">{{ question.title }}</h1>
    </div>
    
    <div class="question-body">
      <p>{{ question.body }}</p>
    </div>
    
    <div class="question-footer">
      <div class="user-info">
        <ion-icon name="person-circle-outline"></ion-icon>
        <span>{{ question.userEmail || 'Anonymous' }}</span>
      </div>
      
      <div class="timestamp" *ngIf="formatDate(question.createdAt)">
        <ion-icon name="time-outline"></ion-icon>
        <span>{{ formatDate(question.createdAt) | date:'MMM d, y' }}</span>
      </div>
    </div>
  </div>
  
  <!-- Answers Section -->
  <div class="answers-section" *ngIf="question.answers && question.answers.length > 0">
    <h2 class="answers-title">Answers ({{ question.answers.length }})</h2>
    
    <div class="answer-item" *ngFor="let answer of question.answers">
      <div class="answer-content">
        <p>{{ answer.text }}</p>
      </div>
      
      <div class="answer-footer">
        <div class="user-info">
          <ion-icon name="person-circle-outline"></ion-icon>
          <span>{{ answer.userEmail || 'Anonymous' }}</span>
        </div>
        
        <div class="timestamp" *ngIf="formatDate(answer.createdAt)">
          <ion-icon name="time-outline"></ion-icon>
          <span>{{ formatDate(answer.createdAt) | date:'MMM d, y' }}</span>
        </div>
        
        <ion-button *ngIf="isCurrentUserAuthor(answer.userId)" 
                  fill="clear"
                  color="danger"
                  size="small"
                  class="delete-button" 
                  (click)="confirmDeleteAnswer(answer)">
          <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
        </ion-button>
      </div>
    </div>
  </div>
  
  <!-- No Answers Message -->
  <div class="answers-section no-answers" *ngIf="!question.answers || question.answers.length === 0">
    <h2 class="answers-title">Answers (0)</h2>
    <div class="no-answers-message">
      <p>No answers yet. Be the first to answer this question!</p>
    </div>
  </div>
  
  <!-- Extra padding at the bottom to prevent content from being hidden behind the answer bar -->
  <div class="content-bottom-padding"></div>
</ion-content>

<!-- Sticky Answer Bar -->
<div class="sticky-answer-bar" [class.expanded]="isAnswerFormExpanded">
  <div class="collapsed-bar" *ngIf="!isAnswerFormExpanded">
    <button class="answer-button" (click)="toggleAnswerForm()">
      <ion-icon name="chatbox-outline"></ion-icon>
      Add Your Answer
    </button>
  </div>
  
  <div class="expanded-form" *ngIf="isAnswerFormExpanded">
    <div class="form-header">
      <h3>Your Answer</h3>
      <button class="close-form-button" (click)="toggleAnswerForm()">
        <ion-icon name="chevron-down-outline"></ion-icon>
      </button>
    </div>
    
    <ion-textarea 
      [(ngModel)]="answerText" 
      placeholder="Write your answer here..." 
      [autoGrow]="true"
      rows="3"
      class="answer-input"
      [disabled]="isSubmitting">
    </ion-textarea>
    
    <div class="form-actions">
      <button 
        class="cancel-button" 
        (click)="toggleAnswerForm()"
        [disabled]="isSubmitting">
        Cancel
      </button>
      <button 
        class="submit-button" 
        (click)="submitAnswer()" 
        [disabled]="isSubmitting || !answerText.trim()">
        <ion-icon name="send-outline"></ion-icon>
        {{ isSubmitting ? 'Posting...' : 'Post Answer' }}
      </button>
    </div>
  </div>
</div>
